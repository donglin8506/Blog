
利用自然语言处理的监督信号


第一步：对比学习式的预训练过程：

!["clip"](../%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/img_and_drawio/clip.png "text")

- 输入N个文本-图片对，每条文本对应一张图片
- N条文本依次输入到文本编码器中，生成N个文本向量$T_1,T_2,T_3,...,T_N$
- N张图片依次输入到图片编码器中，生成N个图片向量$I_1,I_2,I_3,...,I_N$
- 依次计算每个文本向量$T_j$和所有图片向量的相似度，即相似度矩阵的第$j$列
- 或者依次计算每个图片向量$I_i$和所有文本向量的相似度，集相似度矩阵的第$i$行
- 其中相似度矩阵的对角线元素（即蓝色区域）是同一个文本-图片对的相似度；非对角线元素是不配对的文本-图片对
- 训练的目标是配对的文本-图片对的相似度高、不配对的文本-图片的想相似度低

第二步和第三步：如何预测一张图片的标签，即该图片属于类别列表中的哪个类别？


!["clip"](../%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/img_and_drawio/clip2.png "text")

- 目标是：在有标签的测试集合上评估，随便选取一张图片，预测其类别
- 已知测试集合中所有的真实标签，例如包括 plane(飞机)、car(汽车)、dog(狗)、bird(鸟)等
- 由于clip的文本编码器需要输入一个句子，而图片的标签只是一个词，因此可以使用一个句式将词转成句子，例如 dog标签可以转为 A photo of a dog. 这里的句式是不固定的。
- 计算当前图片编码向量与 包含测试集中标签组成的句子的编码向量 之间的相似度
- 选出其中相似度最大的句子，则该句子对应的标签就是图片的预测类别。

